!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rnaplot=e():t.rnaplot=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}([,function(t,e,n){t.exports=n(10)},function(t,e,n){"use strict";n.r(e),n.d(e,"Connection",function(){return s});var r=n(3),o=n(5);function s(){this.loop=new r.a,this.region=new o.a,this.start=null,this.end=null,this.xrad=null,this.yrad=null,this.angle=null,this.extruded=null,this.broken=null,this._isNull=!1}s.prototype.isNull=function(){return this._isNull},s.prototype.setNull=function(t){this._isNull=t},s.prototype.getLoop=function(){return this.loop},s.prototype.setLoop=function(t){this.loop=t},s.prototype.getRegion=function(){return this.region},s.prototype.setRegion=function(t){this.region=t},s.prototype.getStart=function(){return this.start},s.prototype.setStart=function(t){this.start=t},s.prototype.getEnd=function(){return this.end},s.prototype.setEnd=function(t){this.end=t},s.prototype.getXrad=function(){return this.xrad},s.prototype.setXrad=function(t){this.xrad=t},s.prototype.getYrad=function(){return this.yrad},s.prototype.setYrad=function(t){this.yrad=t},s.prototype.getAngle=function(){return this.angle},s.prototype.setAngle=function(t){this.angle=t},s.prototype.isExtruded=function(){return this.extruded},s.prototype.setExtruded=function(t){this.extruded=t},s.prototype.isBroken=function(){return this.broken},s.prototype.setBroken=function(t){this.broken=t}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(2);function o(){this.nconnection=null,this.connections=[],this._connections=[],this.number=null,this.depth=null,this.mark=null,this.x=null,this.y=null,this.radius=null}o.prototype.getNconnection=function(){return this.nconnection},o.prototype.setNconnection=function(t){this.nconnection=t},o.prototype.setConnection=function(t,e){null!=e?this._connections[t]=e:(this._connections[t]||(this._connections[t]=new r.Connection),this._connections[t].setNull(!0))},o.prototype.getConnection=function(t){var e=n(2);this._connections[t]||(this._connections[t]=new e);var r=this._connections[t];return r.isNull()?null:r},o.prototype.addConnection=function(t,e){this._connections.push(e)},o.prototype.getNumber=function(){return this.number},o.prototype.setNumber=function(t){this.number=t},o.prototype.getDepth=function(){return this.depth},o.prototype.setDepth=function(t){this.depth=t},o.prototype.isMark=function(){return this.mark},o.prototype.setMark=function(t){this.mark=t},o.prototype.getX=function(){return this.x},o.prototype.setX=function(t){this.x=t},o.prototype.getY=function(){return this.y},o.prototype.setY=function(t){this.y=t},o.prototype.getRadius=function(){return this.radius},o.prototype.setRadius=function(t){this.radius=t}},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"c",function(){return s}),n.d(e,"a",function(){return i});var r=function(t,e){return t-e};function o(t,e){if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}var s=new function(){var t=this;t.bracketLeft="([{<ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),t.bracketRight=")]}>abcdefghijklmnopqrstuvwxyz".split(""),t.inverseBrackets=function(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=n;return e},t.maximumMatching=function(t){for(var e=t[0],n=new Array(e+1),r=0;r<=e;r++){n[r]=new Array(e+1);for(var o=r;o<=e;o++)n[r][o]=0}var s=0;for(r=e-0-1;r>0;r--)for(o=r+0+1;o<=e;o++){s=n[r][o-1];for(var i=o-0-1;i>=r;i--)t[i]===o&&(s=Math.max(s,(i>r?n[r][i-1]:0)+1+(o-i-1>0?n[i+1][o-1]:0)));n[r][o]=s}return s=n[1][e],n},t.backtrackMaximumMatching=function(e,n){var r=Array.apply(null,Array(e.length)).map(function(){return 0});return t.mmBt(e,r,n,1,e.length-1),r},t.mmBt=function(e,n,r,o,s){var i=e[o][s];if(!(s-o-1<0))if(e[o][s-1]!=i){for(var a=s-0-1;a>=o;a--)if(r[s]===a&&(a>o?e[o][a-1]:0)+(s-a-1>0?e[a+1][s-1]:0)+1==i)return n[a]=s,n[s]=a,o<a&&t.mmBt(e,n,r,o,a-1),void t.mmBt(e,n,r,a+1,s-1);console.log("FAILED!!!"+o+","+s+": backtracking failed!")}else t.mmBt(e,n,r,o,s-1)},t.dotbracketToPairtable=function(e){var n=Array.apply(null,new Array(e.length+1)).map(Number.prototype.valueOf,0);n[0]=e.length;for(var r={},o=0;o<t.bracketLeft.length;o++)r[o]=[];var s=t.inverseBrackets(t.bracketLeft),i=t.inverseBrackets(t.bracketRight);for(o=0;o<e.length;o++){var a=e[o],u=o+1;if("."==a||"o"==a)n[u]=0;else if(a in s)r[s[a]].push(u);else{if(!(a in i))throw"Unknown symbol in dotbracket string";var h=r[i[a]].pop();n[u]=h,n[h]=u}}for(var c in r)if(r[c].length>0)throw"Unmatched base at position "+r[c][0];return n},t.insertIntoStack=function(t,e,n){for(var r=0;t[r].length>0&&t[r][t[r].length-1]<n;)r+=1;return t[r].push(n),r},t.deleteFromStack=function(t,e){for(var n=0;0===t[n].length||t[n][t[n].length-1]!=e;)n+=1;return t[n].pop(),n},t.pairtableToDotbracket=function(e){for(var n={},r=0;r<e[0];r++)n[r]=[];var o={},s="";for(r=1;r<e[0]+1;r++){if(0!==e[r]&&e[r]in o)throw"Invalid pairtable contains duplicate entries";o[e[r]]=!0,0===e[r]?s+=".":e[r]>r?s+=t.bracketLeft[t.insertIntoStack(n,r,e[r])]:s+=t.bracketRight[t.deleteFromStack(n,r)]}return s},t.findUnmatched=function(e,n,r){for(var o=[],s=[],i=n,a=r,u=n;u<=r;u++)0!==e[u]&&(e[u]<n||e[u]>r)&&s.push([u,e[u]]);for(u=i;u<=a;u++){for(;0===e[u]&&u<=a;)u++;for(r=e[u];e[u]===r;)u++,r--;o=o.concat(t.findUnmatched(e,u,r))}return s.length>0&&o.push(s),o},t.removePseudoknotsFromPairtable=function(e){for(var n=t.maximumMatching(e),r=t.backtrackMaximumMatching(n,e),o=[],s=1;s<e.length;s++)e[s]<s||r[s]!=e[s]&&(o.push([s,e[s]]),e[e[s]]=0,e[s]=0);return o},t.ptToElements=function(e,n,o,s,i){var a=[],u=[o-1],h=[s+1];if(arguments.length<5&&(i=[]),o>s)return[];for(;0===e[o];o++)u.push(o);for(;0===e[s];s--)h.push(s);if(o>s){if(u.push(o),0===n)return[["e",n,u.sort(r)]];for(var c=!1,l=[],f=[],g=0;g<u.length;g++)c?f.push(u[g]):l.push(u[g]),i.indexOf(u[g])>=0&&(c=!0);return[["h",n,u.sort(r)]]}if(e[o]!=s){var p=u;for(g=o,p.push(g);g<=s;){for(a=a.concat(t.ptToElements(e,n,g,e[g],i)),p.push(e[g]),g=e[g]+1;0===e[g]&&g<=s;g++)p.push(g);p.push(g)}return p.pop(),(p=p.concat(h)).length>0&&(0===n?a.push(["e",n,p.sort(r)]):a.push(["m",n,p.sort(r)])),a}e[o]===s&&(u.push(o),h.push(s),u.concat(h).length>4&&(0===n?a.push(["e",n,u.concat(h).sort(r)]):a.push(["i",n,u.concat(h).sort(r)])));for(var d=[];e[o]===s&&o<s;)d.push(o),d.push(s),o+=1,s-=1,n+=1;return u=[o-1],h=[s+1],a.push(["s",n,d.sort(r)]),a.concat(t.ptToElements(e,n,o,s,i))}};function i(t){var e=this;return e.colorsText=t,e.parseRange=function(t){for(var e=t.split(","),n=[],r=0;r<e.length;r++){var o=e[r].split("-");if(1==o.length)n.push(parseInt(o[0]));else if(2==o.length)for(var s=parseInt(o[0]),i=parseInt(o[1]),a=s;a<=i;a++)n.push(a);else console.log("Malformed range (too many dashes):",t)}return n},e.parseColorText=function(t){for(var n=t.split("\n"),r="",o=1,s={colorValues:{"":{}},range:["white","steelblue"]},i=[],a=0;a<n.length;a++)if(">"!=n[a][0])for(var u=n[a].trim().split(/[\s]+/),h=0;h<u.length;h++)if(isNaN(u[h])){if(0===u[h].search("range")){var c=u[h].split("=")[1].split(":");s.range=[c[0],c[1]];continue}if(0==u[h].search("domain")){var l=u[h].split("=")[1].split(":");s.domain=[l[0],l[1]];continue}for(var f=u[h].split(":"),g=e.parseRange(f[0]),p=f[1],d=0;d<g.length;d++)isNaN(p)?s.colorValues[r][g[d]]=p:(s.colorValues[r][g[d]]=+p,i.push(Number(p)))}else s.colorValues[r][o]=Number(u[h]),o+=1,i.push(Number(u[h]));else r=n[a].trim().slice(1),o=1,s.colorValues[r]={};return"domain"in s||(s.domain=[Math.min.apply(null,i),Math.max.apply(null,i)]),e.colorsJson=s,e},e.normalizeColors=function(){var t;for(var n in e.colorsJson){var r=Number.MAX_VALUE,o=Number.MIN_VALUE;for(var s in e.colorsJson.colorValues[n])"number"==typeof(t=e.colorsJson.colorValues[n][s])&&(t<r&&(r=t),t>o&&(o=t));for(s in e.colorsJson.colorValues[n])"number"==typeof(t=e.colorsJson.colorValues[n][s])&&(e.colorsJson.colorValues[n][s]=(t-r)/(o-r))}return e},e.parseColorText(e.colorsText),e}},function(t,e,n){"use strict";function r(){this._start1=null,this._end1=null,this._start2=null,this._end2=null}n.d(e,"a",function(){return r}),r.prototype.getStart1=function(){return this._start1},r.prototype.setStart1=function(t){this._start1=t},r.prototype.getEnd1=function(){return this._end1},r.prototype.setEnd1=function(t){this._end1=t},r.prototype.getStart2=function(){return this._start2},r.prototype.setStart2=function(t){this._start2=t},r.prototype.getEnd2=function(){return this._end2},r.prototype.setEnd2=function(t){this._end2=t}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(4),o=n(1),s=n.n(o),i=function(t,e){return t-e};function a(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=this;a.type="rna",a.circularizeExternal=!1,0===arguments.length?(a.seq="",a.dotbracket="",a.structName=""):(a.seq=t,a.dotbracket=e,a.structName=n),a.circular=!1,a.dotbracket.length>0&&"*"==a.dotbracket[a.dotbracket.length-1]&&(a.dotbracket=a.dotbracket.slice(0,a.dotbracket.length-1),a.circular=!0),a.uid=s.a.nice(),a.elements=[],a.pseudoknotPairs=[],a.nucsToNodes={},a.addUids=function(t){for(var e=a.nodes.filter(function(t){return"nucleotide"==t.nodeType}),n=0;n<t.length&&n<e.length;n++)e[n].uid=t[n];return a},a.computePairtable=function(){a.pairtable=r.c.dotbracketToPairtable(a.dotbracket)},a.removeBreaks=function(t){for(var e=[],n=-1;(n=t.indexOf("&"))>=0;)e.push(n),t=t.substring(0,n)+t.substring(n+1,t.length);return{targetString:t,breaks:e}};var u=a.removeBreaks(a.dotbracket);a.dotbracket=u.targetString,a.dotBracketBreaks=u.breaks,u=a.removeBreaks(a.seq),a.seq=u.targetString,a.seqBreaks=u.breaks,a.rnaLength=a.dotbracket.length,Object(r.b)(a.dotBracketBreaks,a.seqBreaks)||(console.log("WARNING: Sequence and structure breaks not equal"),console.log("WARNING: Using the breaks in the structure")),a.computePairtable(),a.addPositions=function(t,e){for(var n=a.nodes.filter(function(e){return e.nodeType==t}),r=0;r<n.length;r++)n[r].x=e[r][0],n[r].px=e[r][0],n[r].y=e[r][1],n[r].py=e[r][1];return a},a.breakNodesToFakeNodes=function(){for(var t=a.nodes.filter(function(t){return"nucleotide"==t.nodeType}),e=0;e<t.length;e++)"o"==a.dotbracket[e]&&(t[e].nodeType="middle");for(var n=function(t){o=!1;for(var e=0;e<a.elements[t][2].length;e++)a.dotBracketBreaks.indexOf(a.elements[t][2][e])>=0&&(o=!0);o?a.elements[t][2].map(function(t){0!=t&&(a.nodes[t-1].elemType="e")}):a.elements[t][2].map(function(e){0!=e&&(a.nodes[e-1].elemType=a.elements[t][0])})},r=0;r<a.elements.length;r++){var o;n(r)}return a},a.getPositions=function(t){for(var e=[],n=a.nodes.filter(function(e){return e.nodeType==t}),r=0;r<n.length;r++)e.push([n[r].x,n[r].y]);return e},a.getUids=function(){for(var t=[],e=0;e<a.dotbracket.length;e++)t.push(a.nodes[e].uid);return t},a.reinforceStems=function(){for(var t=a.pairtable,e=a.elements.filter(function(t){return"s"==t[0]&&t[2].length>=4}),n=0;n<e.length;n++)for(var r=e[n][2],o=r.slice(0,r.length/2),s=0;s<o.length-1;s++)a.addFakeNode([o[s],o[s+1],t[o[s+1]],t[o[s]]]);return a},a.reinforceLoops=function(){for(var t=function(t){return 0!==t&&t<=a.dotbracket.length},e=0;e<a.elements.length;e++)if("s"!=a.elements[e][0]&&(a.circularizeExternal||"e"!=a.elements[e][0])){var n=a.elements[e][2].filter(t);if("e"==a.elements[e][0]){var r={name:"",num:-3,radius:0,rna:a,nodeType:"middle",elemType:"f",nucs:[],x:a.nodes[a.rnaLength-1].x,y:a.nodes[a.rnaLength-1].y,px:a.nodes[a.rnaLength-1].px,py:a.nodes[a.rnaLength-1].py,uid:s.a.nice()},o={name:"",num:-2,radius:0,rna:a,nodeType:"middle",elemType:"f",nucs:[],x:a.nodes[0].x,y:a.nodes[0].y,px:a.nodes[0].px,py:a.nodes[0].py,uid:s.a.nice()};n.push(a.nodes.length+1),n.push(a.nodes.length+2),a.nodes.push(r),a.nodes.push(o)}a.addFakeNode(n)}return a},a.updateLinkUids=function(){for(var t=0;t<a.links.length;t++)a.links[t].uid=a.links[t].source.uid+a.links[t].target.uid;return a},a.addFakeNode=function(t){for(var e=6.283/(2*t.length),n=18/(2*Math.tan(e)),r="",o=0;o<t.length;o++)r+=a.nodes[t[o]-1].uid;var i={name:"",num:-1,radius:n,rna:a,nodeType:"middle",elemType:"f",nucs:t,uid:r};a.nodes.push(i);var u=0,h=0,c=0;e=3.14159*(t.length-2)/(2*t.length),n=.5/Math.cos(e);for(var l=0;l<t.length;l++)if(!(0===t[l]||t[l]>a.dotbracket.length)){a.links.push({source:a.nodes[t[l]-1],target:a.nodes[a.nodes.length-1],linkType:"fake",value:n,uid:s.a.nice()}),t.length>4&&a.links.push({source:a.nodes[t[l]-1],target:a.nodes[t[(l+Math.floor(t.length/2))%t.length]-1],linkType:"fake",value:2*n,uid:s.a.nice()});var f=3.14159*(t.length-2)/t.length,g=2*Math.cos(1.570795-f/2);a.links.push({source:a.nodes[t[l]-1],target:a.nodes[t[(l+2)%t.length]-1],linkType:"fake",value:g});var p=a.nodes[t[l]-1];"x"in p&&(u+=p.x,h+=p.y,c+=1)}return c>0&&(i.x=u/c,i.y=h/c,i.px=i.x,i.py=i.y),a},a.connectFakeNodes=function(){for(var t={},e=a.nodes.filter(function(t){return"middle"==t.nodeType}),n={},r=1;r<=a.nodes.length;r++)t[r]=[];for(r=0;r<e.length;r++)for(var o=e[r],s=0;s<o.nucs.length;s++){for(var i=o.nucs[s],u=0;u<t[i].length;u++)if(!(JSON.stringify([t[i][u].uid,o.uid].sort())in n)){var h=t[i][u].radius+o.radius;a.links.push({source:t[i][u],target:o,value:h/18,linkType:"fake_fake"}),n[JSON.stringify([t[i][u].uid,o.uid].sort())]=!0}t[i].push(o)}return a},a.addExtraLinks=function(t){if(void 0===t)return a;for(var e=0;e<t.length;e++){var n={source:a.getNodeFromNucleotides(t[e].from),target:a.getNodeFromNucleotides(t[e].to),linkType:"extra",extraLinkType:t[e].linkType,uid:s.a.nice()};a.links.push(n)}return a},a.elementsToJson=function(){var t=a.pairtable;a.elements;a.nodes=[],a.links=[];var e={};a.elements.sort();for(var n=0;n<a.elements.length;n++)for(var r=a.elements[n][2],i=0;i<r.length;i++)e[r[i]]=a.elements[n][0];for(var u=1;u<=t[0];u++){var h=a.seq[u-1];(a.dotBracketBreaks.indexOf(u-1)>=0||a.dotBracketBreaks.indexOf(u-2)>=0)&&(h=""),a.nodes.push({name:h,num:o+u-1,radius:5,rna:a,nodeType:"nucleotide",structName:a.structName,elemType:e[u],uid:s.a.nice(),linked:!1})}for(var c=0;c<a.nodes.length;c++)a.nodes[c].prevNode=0===c?null:a.nodes[c-1],c==a.nodes.length-1?a.nodes[c].nextNode=null:a.nodes[c].nextNode=a.nodes[c+1];for(var l=1;l<=t[0];l++)0!==t[l]&&a.links.push({source:a.nodes[l-1],target:a.nodes[t[l]-1],linkType:"basepair",value:1,uid:s.a.nice()}),l>1&&-1===a.dotBracketBreaks.indexOf(l-1)&&-1==a.dotBracketBreaks.indexOf(l-2)&&-1==a.dotBracketBreaks.indexOf(l-3)&&(a.links.push({source:a.nodes[l-2],target:a.nodes[l-1],linkType:"backbone",value:1,uid:s.a.nice()}),a.nodes[l-1].linked=!0);for(var f=0;f<a.pseudoknotPairs.length;f++)a.links.push({source:a.nodes[a.pseudoknotPairs[f][0]-1],target:a.nodes[a.pseudoknotPairs[f][1]-1],linkType:"pseudoknot",value:1,uid:s.a.nice()});return a.circular&&a.links.push({source:a.nodes[0],target:a.nodes[a.rnaLength-1],linkType:"backbone",value:1,uid:s.a.nice()}),a},a.ptToElements=function(t,e,n,r){var o=[],s=[n-1],u=[r+1];if(n>r)return[];for(;0===t[n];n++)s.push(n);for(;0===t[r];r--)u.push(r);if(n>r){if(s.push(n),0===e)return[["e",e,s.sort(i)]];for(var h=!1,c=[],l=[],f=0;f<s.length;f++)h?l.push(s[f]):c.push(s[f]),a.dotBracketBreaks.indexOf(s[f])>=0&&(h=!0);return[["h",e,s.sort(i)]]}if(t[n]!=r){var g=s;f=n;for(g.push(f);f<=r;){for(o=o.concat(a.ptToElements(t,e,f,t[f])),g.push(t[f]),f=t[f]+1;0===t[f]&&f<=r;f++)g.push(f);g.push(f)}return g.pop(),(g=g.concat(u)).length>0&&(0===e?o.push(["e",e,g.sort(i)]):o.push(["m",e,g.sort(i)])),o}t[n]===r&&(s.push(n),u.push(r),s.concat(u).length>4&&(0===e?o.push(["e",e,s.concat(u).sort(i)]):o.push(["i",e,s.concat(u).sort(i)])));for(var p=[];t[n]===r&&n<r;)p.push(n),p.push(r),n+=1,r-=1,e+=1;return s=[n-1],u=[r+1],o.push(["s",e,p.sort(i)]),o.concat(a.ptToElements(t,e,n,r))},a.addLabels=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(0===e)return a;for(var n=1;n<=a.rnaLength;n++)if(n%e==0){var r,o,i=a.nodes[n-1],u=void 0,h=void 0,c=void 0,l=void 0;1==a.rnaLength?(l=[i.x-15,i.y],c=[i.x-15,i.y]):(u=1==n?a.nodes[a.rnaLength-1]:a.nodes[n-2],h=n==a.rnaLength?a.nodes[0]:a.nodes[n],0!==a.pairtable[h.num-t+1]&&0!==a.pairtable[u.num-t+1]&&0!==a.pairtable[i.num-t+1]&&(u=h=a.nodes[a.pairtable[i.num-t+1]-1]),0===a.pairtable[i.num-t+1]||0!==a.pairtable[h.num-t+1]&&0!==a.pairtable[u.num-t+1]?(l=[h.x-i.x,h.y-i.y],c=[u.x-i.x,u.y-i.y]):(l=[i.x-h.x,i.y-h.y],c=[i.x-u.x,i.y-u.y]));var f=[l[0]+c[0],l[1]+c[1]],g=Math.sqrt(f[0]*f[0]+f[1]*f[1]),p=[f[0]/g,f[1]/g],d=[-15*p[0],-15*p[1]];r=a.nodes[n-1].x+d[0],o=a.nodes[n-1].y+d[1];var b={name:n+t-1,num:-1,radius:6,rna:a,nodeType:"label",structName:a.structName,elemType:"l",x:r,y:o,px:r,py:o,uid:s.a.nice()},y={source:a.nodes[n-1],target:b,value:1,linkType:"label_link",uid:s.a.nice()};a.nodes.push(b),a.links.push(y)}return a},a.recalculateElements=function(){if(a.removePseudoknots(),a.elements=a.ptToElements(a.pairtable,0,1,a.dotbracket.length),a.circular&&(externalLoop=a.elements.filter(function(t){if("e"==t[0])return!0}),externalLoop.length>0)){eloop=externalLoop[0],nucs=eloop[2].sort(i),prev=nucs[0],hloop=!0,numGreater=0;for(var t=1;t<nucs.length;t++)nucs[t]-prev>1&&(numGreater+=1),prev=nucs[t];1==numGreater?eloop[0]="h":2==numGreater?eloop[0]="i":eloop[0]="m"}return a},a.reassignLinkUids=function(){for(var t=0;t<a.links.length;t++)a.links[t].uid=a.links[t].source.uid+a.links[t].target.uid;return a},a.removePseudoknots=function(){return a.pairtable.length>1&&(a.pseudoknotPairs=a.pseudoknotPairs.concat(r.c.removePseudoknotsFromPairtable(a.pairtable))),a},a.addPseudoknots=function(){for(var t=a.pairtable,e=a.pseudoknotPairs,n=0;n<e.length;n++)t[e[n][0]]=e[n][1],t[e[n][1]]=e[n][0];return a.pseudoknotPairs=[],a},a.addName=function(t){return void 0===t?(a.name="",a):(a.name=t,a)},a.rnaLength>0&&a.recalculateElements(),a.getNodeFromNucleotides=function(t){if("[object Array]"===Object.prototype.toString.call(t)){for(var e=0;e<a.nodes.length;e++)if("nucs"in a.nodes[e]&&a.nodes[e].nucs.equals(t))return a.nodes[e]}else for(e=0;e<a.nodes.length;e++)if(a.nodes[e].num==t)return a.nodes[e];return console.log("ERROR: No node found for nucs:",t),null}}void 0===String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")})},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function r(t){var e,n,r,o=[],s=[];n=t[0];var i=Array.apply(null,new Array(n+5)).map(Number.prototype.valueOf,0),a=Array.apply(null,new Array(16+Math.floor(n/5))).map(Number.prototype.valueOf,0),u=Array.apply(null,new Array(16+Math.floor(n/5))).map(Number.prototype.valueOf,0),h=0,c=0,l=Math.PI/2;!function t(e,n,r){var o,s,f,g,p,d,b,y,v,m,E,w,_=2,k=0,x=0,A=Array.apply(null,new Array(3+2*Math.floor((n-e)/5))).map(Number.prototype.valueOf,0);for(o=e-1,n++;e!=n;)if((s=r[e])&&0!=e){_+=2,f=e,g=s,A[++k]=f,A[++k]=g,e=s+1,p=f,d=g,y=0;do{f++,g--,y++}while(r[f]==g&&r[f]>f);if(b=y-2,y>=2&&(i[p+1+b]+=l,i[d-1-b]+=l,i[p]+=l,i[d]+=l,y>2))for(;b>=1;b--)i[p+b]=Math.PI,i[d-b]=Math.PI;u[++c]=y,f<=g&&t(f,g,r)}else e++,_++,x++;for(w=Math.PI*(_-2)/_,A[++k]=n,v=o<0?0:o,m=1;m<=k;m++){for(E=A[m]-v,b=0;b<=E;b++)i[v+b]+=w;if(m>k)break;v=A[++m]}a[++h]=x}(0,n+1,t),a[h]-=2,r=0,o[0]=100,s[0]=100;var f=[];for(f.push([o[0],s[0]]),e=1;e<n;e++)o[e]=o[e-1]+15*Math.cos(r),s[e]=s[e-1]+15*Math.sin(r),f.push([o[e],s[e]]),r+=Math.PI-i[e+1];return f}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";function r(){this.radius=null,this.loopnumber=null,this.next=null,this.prev=null}r.prototype.getRadius=function(){return this.radius},r.prototype.setRadius=function(t){this.radius=t},r.prototype.getLoopnumber=function(){return this.loopnumber},r.prototype.setLoopnumber=function(t){this.loopnumber=t},r.prototype.getNext=function(){return this.next},r.prototype.setNext=function(t){this.next=t},r.prototype.getPrev=function(){return this.prev},r.prototype.setPrev=function(t){this.prev=t};var o=n(2),s=n(5);function i(){this.mate=null,this.x=null,this.y=null,this.extracted=null,this.region=new s.a}i.prototype.getMate=function(){return this.mate},i.prototype.setMate=function(t){this.mate=t},i.prototype.getX=function(){return this.x},i.prototype.setX=function(t){this.x=t},i.prototype.getY=function(){return this.y},i.prototype.setY=function(t){this.y=t},i.prototype.isExtracted=function(){return this.extracted},i.prototype.setExtracted=function(t){this.extracted=t},i.prototype.getRegion=function(){return this.region},i.prototype.setRegion=function(t){this.region=t};var a=n(3);function u(){this.ANUM=9999,this.MAXITER=500,this.bases=[],this.nbase=null,this.nregion=null,this.loop_count=null,this.root=new a.a,this.loops=[],this.regions=[],this.rlphead=new r,this.lencut=.8,this.RADIUS_REDUCTION_FACTOR=1.4,this.angleinc=null,this._h=null,this.HELIX_FACTOR=.6,this.BACKBONE_DISTANCE=27}function h(t){var e=null,n=null,r=null;if(t.getNconnection()<=1)return 0;if(t.isMark())return-1;t.setMark(!0),e=0,n=0;for(var o=0;null!=t.getConnection(o);o++)(r=h(t.getConnection(o).getLoop()))>=0&&(1==++e?n=r:n>r&&(n=r));return t.setMark(!1),n+1}n.d(e,"a",function(){return u}),u.prototype.naview_xy_coordinates=function(t){var e,n=[],r=[];if(0===t.length||0===t[0])return 0;this.nbase=t[0],this.bases=[];for(var o=0;o<this.nbase+1;o++)this.bases.push(new i);this.regions=[];for(o=0;o<this.nbase+1;o++)this.regions.push(new s.a);this.read_in_bases(t),this.rlphead=null,this.find_regions(),this.loop_count=0,this.loops=[];for(o=0;o<this.nbase+1;o++)this.loops.push(new a.a);for(this.construct_loop(0),this.find_central_loop(),this.traverse_loop(this.root,null),e=0;e<this.nbase;e++)n.push(100+this.BACKBONE_DISTANCE*this.bases[e+1].getX()),r.push(100+this.BACKBONE_DISTANCE*this.bases[e+1].getY());return{nbase:this.nbase,x:n,y:r}},u.prototype.read_in_bases=function(t){var e=null,n=null;for(this.bases.push(new i),this.bases[0].setMate(0),this.bases[0].setExtracted(!1),this.bases[0].setX(this.ANUM),this.bases[0].setY(this.ANUM),n=0,e=1;e<=this.nbase;e++)this.bases.push(new i),this.bases[e].setExtracted(!1),this.bases[e].setX(this.ANUM),this.bases[e].setY(this.ANUM),this.bases[e].setMate(t[e]),t[e]>e&&n++;0==n&&(this.bases[1].setMate(this.nbase),this.bases[this.nbase].setMate(1))},u.prototype.find_regions=function(){var t,e=null,n=null;t=this.nbase+1;var r=[];for(e=0;e<t;e++)r.push(!1);for(this.nregion=0,e=0;e<=this.nbase;e++)if(0!=(n=this.bases[e].getMate())&&!r[e]){for(this.regions[this.nregion].setStart1(e),this.regions[this.nregion].setEnd2(n),r[e]=!0,r[n]=!0,this.bases[e].setRegion(this.regions[this.nregion]),this.bases[n].setRegion(this.regions[this.nregion]),e++,n--;e<n&&this.bases[e].getMate()==n;e++,n--)r[n]=!0,r[e]=!0,this.bases[e].setRegion(this.regions[this.nregion]),this.bases[n].setRegion(this.regions[this.nregion]);this.regions[this.nregion].setEnd1(--e),this.regions[this.nregion].setStart2(n+1),this.nregion++}},u.prototype.construct_loop=function(t){var e=null,n=null,i=new a.a,u=new a.a,h=new o.Connection,c=new s.a,l=new r;for((i=this.loops[this.loop_count++]).setNconnection(0),i.setDepth(0),i.setNumber(this.loop_count),i.setRadius(0),l=this.rlphead;null!=l;l=l.getNext())l.getLoopnumber()==this.loop_count&&i.setRadius(l.getRadius());e=t;do{0!=(n=this.bases[e].getMate())&&(c=this.bases[e].getRegion(),this.bases[c.getStart1()].isExtracted()||(e==c.getStart1()?(this.bases[c.getStart1()].setExtracted(!0),this.bases[c.getEnd1()].setExtracted(!0),this.bases[c.getStart2()].setExtracted(!0),this.bases[c.getEnd2()].setExtracted(!0),u=this.construct_loop(c.getEnd1()<this.nbase?c.getEnd1()+1:0)):e==c.getStart2()?(this.bases[c.getStart2()].setExtracted(!0),this.bases[c.getEnd2()].setExtracted(!0),this.bases[c.getStart1()].setExtracted(!0),this.bases[c.getEnd1()].setExtracted(!0),u=this.construct_loop(c.getEnd2()<this.nbase?c.getEnd2()+1:0)):console.log("Something went terribly wrong ...."),i.setNconnection(i.getNconnection()+1),h=new o.Connection,i.setConnection(i.getNconnection()-1,h),i.setConnection(i.getNconnection(),null),h.setLoop(u),h.setRegion(c),e==c.getStart1()?(h.setStart(c.getStart1()),h.setEnd(c.getEnd2())):(h.setStart(c.getStart2()),h.setEnd(c.getEnd1())),h.setExtruded(!1),h.setBroken(!1),u.setNconnection(u.getNconnection()+1),h=new o.Connection,u.setConnection(u.getNconnection()-1,h),u.setConnection(u.getNconnection(),null),h.setLoop(i),h.setRegion(c),e==c.getStart1()?(h.setStart(c.getStart2()),h.setEnd(c.getEnd1())):(h.setStart(c.getStart1()),h.setEnd(c.getEnd2())),h.setExtruded(!1),h.setBroken(!1)),e=n),++e>this.nbase&&(e=0)}while(e!=t);return i},u.prototype.find_central_loop=function(){var t=new a.a,e=null,n=null,r=null;for(function(){var t=new a.a,e=null,n=null;for(e=0;e<this.loop_count;e++){for(t=this.loops[e],n=0;n<this.loop_count;n++)this.loops[n].setMark(!1);t.setDepth(h(t))}}.bind(this)(),e=0,n=-1,r=0;r<this.loop_count;r++)(t=this.loops[r]).getNconnection()>e?(n=t.getDepth(),e=t.getNconnection(),this.root=t):t.getDepth()>n&&t.getNconnection()==e&&(n=t.getDepth(),this.root=t)},u.prototype.traverse_loop=function(t,e){var n,r,o,s,i,a,u,h,c,l,f,g,p,d,b,y,v,m,E,w,_,k,x,A,M,N,P,R,S,T,Y,I,B,L,C,U,X,O,D,F,q,j,V,z,J,G,H,K,W,Z,Q,$,tt,et,nt,rt,ot,st,it,at,ut,ht,ct,lt,ft,gt,pt,dt,bt,yt=0;a=2*Math.PI/(this.nbase+1),m=null,T=-1;var vt=0;for(x=0;null!=(y=t.getConnection(vt));vt++,x++)n=-Math.sin(a*y.getStart()),r=Math.cos(a*y.getStart()),o=-Math.sin(a*y.getEnd()),s=Math.cos(a*y.getEnd())-r,i=n-o,u=Math.sqrt(s*s+i*i),y.setXrad(s/u),y.setYrad(i/u),y.setAngle(Math.atan2(i,s)),y.getAngle()<0&&y.setAngle(y.getAngle()+2*Math.PI),null!=e&&e.getRegion()==y.getRegion()&&(m=y,T=x);t:for(;;){this.determine_radius(t,this.lencut),h=t.getRadius()/this.RADIUS_REDUCTION_FACTOR,null==e?c=l=0:(f=(this.bases[m.getStart()].getX()+this.bases[m.getEnd()].getX())/2,g=(this.bases[m.getStart()].getY()+this.bases[m.getEnd()].getY())/2,c=f-h*m.getXrad(),l=g-h*m.getYrad()),P=-1==T?0:T,y=t.getConnection(P),N=0,Y=!1;do{if((_=P-1)<0&&(_=t.getNconnection()-1),E=t.getConnection(_),this.connected_connection(E,y)?(P=_,y=E):Y=!0,++N>t.getNconnection()){for(M=-1,x=0;x<t.getNconnection();x++)(_=x+1)>=t.getNconnection()&&(_=0),y=t.getConnection(x),(ft=(v=t.getConnection(_)).getAngle()-y.getAngle())<0&&(ft+=2*Math.PI),ft>M&&(M=ft,yt=x);R=yt,(P=yt+1)>=t.getNconnection()&&(P=0),(y=t.getConnection(R)).setBroken(!0),Y=!0}}while(!Y);for(I=!1,G=P;!I;){for(N=0,Y=!1,R=P,B=!1;!Y;)if(y=t.getConnection(R),R==T&&(B=!0),(_=R+1)>=t.getNconnection()&&(_=0),v=t.getConnection(_),this.connected_connection(y,v)){if(++N>=t.getNconnection())break;R=_}else Y=!0;for(x=H=K=S=this.find_ic_middle(P,R,e,m,t),Y=!1,Z=0;!Y;)(x=Z<0?H:0==Z?S:K)>=0&&(y=t.getConnection(x),null!=e&&m==y||(0==Z?(p=y.getAngle()-Math.asin(.5/h),d=y.getAngle()+Math.asin(.5/h),this.bases[y.getStart()].setX(c+h*Math.cos(p)),this.bases[y.getStart()].setY(l+h*Math.sin(p)),this.bases[y.getEnd()].setX(c+h*Math.cos(d)),this.bases[y.getEnd()].setY(l+h*Math.sin(d))):Z<0?((_=x+1)>=t.getNconnection()&&(_=0),y=t.getConnection(x),v=t.getConnection(_),nt=y.getXrad(),rt=y.getYrad(),ft=(y.getAngle()+v.getAngle())/2,y.getAngle()>v.getAngle()&&(ft-=Math.PI),it=Math.cos(ft),ht=Math.sin(ft),ct=-it,(A=v.getAngle()-y.getAngle())<0&&(A+=2*Math.PI),lt=y.isExtruded()?A<=Math.PI/2?2:1.5:1,this.bases[y.getEnd()].setX(this.bases[v.getStart()].getX()+lt*ht),this.bases[y.getEnd()].setY(this.bases[v.getStart()].getY()+lt*ct),this.bases[y.getStart()].setX(this.bases[y.getEnd()].getX()+rt),this.bases[y.getStart()].setY(this.bases[y.getEnd()].getY()-nt)):((_=x-1)<0&&(_=t.getNconnection()-1),y=t.getConnection(_),ot=(v=t.getConnection(x)).getXrad(),st=v.getYrad(),ft=(y.getAngle()+v.getAngle())/2,y.getAngle()>v.getAngle()&&(ft-=Math.PI),it=Math.cos(ft),ht=-Math.sin(ft),ct=it,(A=v.getAngle()-y.getAngle())<0&&(A+=2*Math.PI),lt=y.isExtruded()?A<=Math.PI/2?2:1.5:1,this.bases[v.getStart()].setX(this.bases[y.getEnd()].getX()+lt*ht),this.bases[v.getStart()].setY(this.bases[y.getEnd()].getY()+lt*ct),this.bases[v.getEnd()].setX(this.bases[v.getStart()].getX()-st),this.bases[v.getEnd()].setY(this.bases[v.getStart()].getY()+ot)))),Z<0?(K==R?K=-1:K>=0&&++K>=t.getNconnection()&&(K=0),Z=1):(H==P?H=-1:H>=0&&--H<0&&(H=t.getNconnection()-1),Z=-1),Y=-1==H&&-1==K;if((W=R+1)>=t.getNconnection()&&(W=0),R!=P&&(P!=G||W!=G))if(y=t.getConnection(P),v=t.getConnection(R),$=this.bases[v.getEnd()].getX()-this.bases[y.getStart()].getX(),tt=this.bases[v.getEnd()].getY()-this.bases[y.getStart()].getY(),C=this.bases[y.getStart()].getX()+$/2,U=this.bases[y.getStart()].getY()+tt/2,D=$/(et=Math.sqrt($*$+tt*tt)),F=tt/et,q=c-C,j=l-U,X=(V=(q/=et=Math.sqrt($*$+tt*tt))*D+(j/=et)*F)*D-q,O=V*F-j,X/=et=Math.sqrt(X*X+O*O),O/=et,$=this.bases[y.getStart()].getX()-c,tt=this.bases[y.getStart()].getY()-l,(ft=Math.atan2(tt,$))<0&&(ft+=2*Math.PI),$=this.bases[v.getEnd()].getX()-c,tt=this.bases[v.getEnd()].getY()-l,(gt=Math.atan2(tt,$))<0&&(gt+=2*Math.PI),gt<ft&&(gt+=2*Math.PI),z=c+(L=gt-ft>Math.PI?-1:1)*h*X,J=l+L*h*O,B)c-=z-C,l-=J-U;else for(x=P;w=(y=t.getConnection(x)).getStart(),this.bases[w].setX(this.bases[w].getX()+z-C),this.bases[w].setY(this.bases[w].getY()+J-U),w=y.getEnd(),this.bases[w].setX(this.bases[w].getX()+z-C),this.bases[w].setY(this.bases[w].getY()+J-U),x!=R;)++x>=t.getNconnection()&&(x=0);I=(P=W)==G}for(x=0;x<t.getNconnection();x++){if(y=t.getConnection(x),(_=x+1)>=t.getNconnection()&&(_=0),v=t.getConnection(_),$=this.bases[y.getEnd()].getX()-c,tt=this.bases[y.getEnd()].getY()-l,ut=Math.sqrt($*$+tt*tt),(ft=Math.atan2(tt,$))<0&&(ft+=2*Math.PI),$=this.bases[v.getStart()].getX()-c,tt=this.bases[v.getStart()].getY()-l,at=Math.sqrt($*$+tt*tt),(gt=Math.atan2(tt,$))<0&&(gt+=2*Math.PI),gt<ft&&(gt+=2*Math.PI),Q=gt-ft,(bt=v.getAngle()-y.getAngle())<=0&&(bt+=2*Math.PI),Math.abs(Q-bt)>Math.PI)if(y.isExtruded())console.log("Warning from traverse_loop. Loop "+t.getNumber()+" has crossed regions\n");else if(v.getStart()-y.getEnd()!=1){y.setExtruded(!0);continue t}if(y.isExtruded())this.construct_extruded_segment(y,v);else for((k=v.getStart()-y.getEnd())<0&&(k+=this.nbase+1),a=Q/k,_=1;_<k;_++)(w=y.getEnd()+_)>this.nbase&&(w-=this.nbase+1),et=ut+(at-ut)*((b=ft+_*a)-ft)/Q,this.bases[w].setX(c+et*Math.cos(b)),this.bases[w].setY(l+et*Math.sin(b))}break}for(x=0;x<t.getNconnection();x++)T!=x&&(y=t.getConnection(x),this.generate_region(y),this.traverse_loop(y.getLoop(),y));for(k=0,pt=0,dt=0,x=0;x<t.getNconnection();x++)if((_=x+1)>=t.getNconnection()&&(_=0),y=t.getConnection(x),v=t.getConnection(_),k+=2,pt+=this.bases[y.getStart()].getX()+this.bases[y.getEnd()].getX(),dt+=this.bases[y.getStart()].getY()+this.bases[y.getEnd()].getY(),!y.isExtruded())for(_=y.getEnd()+1;_!=v.getStart();_++)_>this.nbase&&(_-=this.nbase+1),k++,pt+=this.bases[_].getX(),dt+=this.bases[_].getY();t.setX(pt/k),t.setY(dt/k)},u.prototype.determine_radius=function(t,e){var n,r,s,i,a,u,h,c,l,f,g,p=0,d=new o.Connection,b=new o.Connection;do{for(n=1e10,a=0,i=0,c=0;c<t.getNconnection();c++)d=t.getConnection(c),(l=c+1)>=t.getNconnection()&&(l=0),b=t.getConnection(l),f=d.getEnd(),(g=b.getStart())<f&&(g+=this.nbase+1),(s=b.getAngle()-d.getAngle())<=0&&(s+=2*Math.PI),i+=s*(1/(r=d.isExtruded()?s<=Math.PI/2?2:1.5:g-f)+1),a+=s*s/r,(h=s/r)<n&&!d.isExtruded()&&r>1&&(n=h,p=c);(u=i/a)<.7071068&&(u=.7071068),n*u<e&&t.getConnection(p).setExtruded(!0)}while(n*u<e);t.getRadius()>0?u=t.getRadius():t.setRadius(u)},u.prototype.find_ic_middle=function(t,e,n,r,o){var s,i,a,u,h;for(s=0,i=-1,a=t,h=!1;!h;)s++>2*o.getNconnection()&&console.log("Infinite loop in 'find_ic_middle'"),null!=n&&o.getConnection(a)==r&&(i=a),h=a==e,++a>=o.getNconnection()&&(a=0);if(-1==i){for(u=1,a=t;u<(s+1)/2;u++)++a>=o.getNconnection()&&(a=0);i=a}return i},u.prototype.construct_extruded_segment=function(t,e){var n,r,o,s,i,a,u,h,c,l,f,g,p,d,b,y,v,m;if(n=t.getAngle(),(o=r=e.getAngle())<n&&(o+=2*Math.PI),s=(n+o)/2,p=t.getEnd(),(b=(d=e.getStart())-p)<0&&(b+=this.nbase+1),(f=e.getAngle()-t.getAngle())<0&&(f+=2*Math.PI),2==b)this.construct_circle_segment(p,d);else{i=this.bases[d].getX()-this.bases[p].getX(),a=this.bases[d].getY()-this.bases[p].getY(),i/=l=Math.sqrt(i*i+a*a),a/=l,l>=1.5&&f<=Math.PI/2&&((y=p+1)>this.nbase&&(y-=this.nbase+1),(v=d-1)<0&&(v+=this.nbase+1),this.bases[y].setX(this.bases[p].getX()+.5*i),this.bases[y].setY(this.bases[p].getY()+.5*a),this.bases[v].setX(this.bases[d].getX()-.5*i),this.bases[v].setY(this.bases[d].getY()-.5*a),p=y,d=v);do{m=!1,this.construct_circle_segment(p,d),(y=p+1)>this.nbase&&(y-=this.nbase+1),i=this.bases[y].getX()-this.bases[p].getX(),a=this.bases[y].getY()-this.bases[p].getY(),(u=Math.atan2(a,i))<0&&(u+=2*Math.PI),(g=u-n)<0&&(g+=2*Math.PI),g>Math.PI&&(m=!0),(v=d-1)<0&&(v+=this.nbase+1),i=this.bases[v].getX()-this.bases[d].getX(),a=this.bases[v].getY()-this.bases[d].getY(),(h=Math.atan2(a,i))<0&&(h+=2*Math.PI),(g=r-h)<0&&(g+=2*Math.PI),g>Math.PI&&(m=!0),m&&(c=this.minf2(s,n+.5),this.bases[y].setX(this.bases[p].getX()+Math.cos(c)),this.bases[y].setY(this.bases[p].getY()+Math.sin(c)),p=y,c=this.maxf2(s,o-.5),this.bases[v].setX(this.bases[d].getX()+Math.cos(c)),this.bases[v].setY(this.bases[d].getY()+Math.sin(c)),d=v,b-=2)}while(m&&b>1)}},u.prototype.construct_circle_segment=function(t,e){var n,r,o,s,i,a,u,h,c,l,f,g,p,d,b;if(n=this.bases[e].getX()-this.bases[t].getX(),r=this.bases[e].getY()-this.bases[t].getY(),o=Math.sqrt(n*n+r*r),(p=e-t)<0&&(p+=this.nbase+1),o>=p)for(n/=o,r/=o,d=1;d<p;d++)(b=t+d)>this.nbase&&(b-=this.nbase+1),this.bases[b].setX(this.bases[t].getX()+n*d/p),this.bases[b].setY(this.bases[t].getY()+r*d/p);else for(this.find_center_for_arc(p-1,o),n/=o,r/=o,s=this.bases[t].getX()+n*o/2,i=this.bases[t].getY()+r*o/2,a=r,u=-n,h=s+this._h*a,c=i+this._h*u,l=this.bases[t].getX()-h,f=this.bases[t].getY()-c,o=Math.sqrt(l*l+f*f),g=Math.atan2(f,l),d=1;d<p;d++)(b=t+d)>this.nbase&&(b-=this.nbase+1),this.bases[b].setX(h+o*Math.cos(g+d*this.angleinc)),this.bases[b].setY(c+o*Math.sin(g+d*this.angleinc))},u.prototype.find_center_for_arc=function(t,e){var n,r,o,s,i,a,u,h;o=-(r=(t+1)/Math.PI)-e/(t+1.000001-e),e<1&&(o=0),h=0;do{n=(r+o)/2,i=1-.5/((s=Math.sqrt(n*n+e*e/4))*s),Math.abs(i)>1&&console.log("Unexpected large magnitude discriminant = "+i+" "+s),(u=(a=Math.acos(i))*(t+1)+2*Math.acos(n/s)-2*Math.PI)>0?o=n:r=n}while(Math.abs(u)>1e-4&&++h<this.MAXITER);h>=this.MAXITER&&(noIterationFailureYet&&(console.log("Iteration failed in find_center_for_arc"),noIterationFailureYet=!1),n=0,a=0),this._h=n,this.angleinc=a},u.prototype.generate_region=function(t){var e,n,r,o,s,i;for(i=t.getRegion(),e=0,t.getStart()==i.getStart1()?(n=i.getStart1(),r=i.getEnd1()):(n=i.getStart2(),r=i.getEnd2()),(this.bases[t.getStart()].getX()>this.ANUM-100||this.bases[t.getEnd()].getX()>this.ANUM-100)&&console.log("Bad region passed to generate_region. Coordinates not defined."),o=n+1;o<=r;o++)e++,this.bases[o].setX(this.bases[t.getStart()].getX()+this.HELIX_FACTOR*e*t.getXrad()),this.bases[o].setY(this.bases[t.getStart()].getY()+this.HELIX_FACTOR*e*t.getYrad()),s=this.bases[o].getMate(),this.bases[s].setX(this.bases[t.getEnd()].getX()+this.HELIX_FACTOR*e*t.getXrad()),this.bases[s].setY(this.bases[t.getEnd()].getY()+this.HELIX_FACTOR*e*t.getYrad())},u.prototype.minf2=function(t,e){return t<e?t:e},u.prototype.maxf2=function(t,e){return t>e?t:e},u.prototype.connected_connection=function(t,e){return!!t.isExtruded()||t.getEnd()+1==e.getStart()}},function(t,e,n){(function(t){var r=n(15);e.encode=function(e){var n=r.parse(e);return new t(n).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").substring(0,22)},e.decode=function(e){var n=e.replace(/-/g,"+").replace(/_/g,"/")+"==";return r.unparse(new t(n,"base64"))},e.v4=function(){return r.v4(null,new t(16)).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").substring(0,22)},e.nice=function(){var e=r.v4(null,new t(16));return e[0]=127&e[0],e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").substring(0,22)}}).call(this,n(11).Buffer)},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(12),o=n(13),s=n(14);function i(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(i()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return h(this,t,e,n)}function h(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),o=(t=a(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|g(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):f(t,e);if("Buffer"===e.type&&s(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(c(e),t=a(t,e<0?0:0|g(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|g(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function g(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(r)return D(t).length;e=(""+e).toLowerCase(),r=!0}}function d(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,o);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,o){var s,i=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;i=2,a/=2,u/=2,n/=2}function h(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(o){var c=-1;for(s=n;s<a;s++)if(h(t,s)===h(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===u)return c*i}else-1!==c&&(s-=s-c),c=-1}else for(n+u>a&&(n=a-u),s=n;s>=0;s--){for(var l=!0,f=0;f<u;f++)if(h(t,s+f)!==h(e,f)){l=!1;break}if(l)return s}return-1}function v(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var i=0;i<r;++i){var a=parseInt(e.substr(2*i,2),16);if(isNaN(a))return i;t[n+i]=a}return i}function m(t,e,n,r){return q(D(e,t.length-n),t,n,r)}function E(t,e,n,r){return q(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return E(t,e,n,r)}function _(t,e,n,r){return q(F(e),t,n,r)}function k(t,e,n,r){return q(function(t,e){for(var n,r,o,s=[],i=0;i<t.length&&!((e-=2)<0);++i)n=t.charCodeAt(i),r=n>>8,o=n%256,s.push(o),s.push(r);return s}(e,t.length-n),t,n,r)}function x(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function A(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var s,i,a,u,h=t[o],c=null,l=h>239?4:h>223?3:h>191?2:1;if(o+l<=n)switch(l){case 1:h<128&&(c=h);break;case 2:128==(192&(s=t[o+1]))&&(u=(31&h)<<6|63&s)>127&&(c=u);break;case 3:s=t[o+1],i=t[o+2],128==(192&s)&&128==(192&i)&&(u=(15&h)<<12|(63&s)<<6|63&i)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:s=t[o+1],i=t[o+2],a=t[o+3],128==(192&s)&&128==(192&i)&&128==(192&a)&&(u=(15&h)<<18|(63&s)<<12|(63&i)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,l=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),o+=l}return function(t){var e=t.length;if(e<=M)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=M));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=i(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return h(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return c(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return l(null,t)},u.allocUnsafeSlow=function(t){return l(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,s=Math.min(n,r);o<s;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var i=t[n];if(!u.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return N(this,e,n);case"latin1":case"binary":return P(this,e,n);case"base64":return x(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,o){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(o>>>=0)-(r>>>=0),i=(n>>>=0)-(e>>>=0),a=Math.min(s,i),h=this.slice(r,o),c=t.slice(e,n),l=0;l<a;++l)if(h[l]!==c[l]){s=h[l],i=c[l];break}return s<i?-1:i<s?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return m(this,t,e,n);case"ascii":return E(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function N(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function P(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function R(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",s=e;s<n;++s)o+=O(t[s]);return o}function S(t,e,n){for(var r=t.slice(e,n),o="",s=0;s<r.length;s+=2)o+=String.fromCharCode(r[s]+256*r[s+1]);return o}function T(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Y(t,e,n,r,o,s){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function I(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,s=Math.min(t.length-n,2);o<s;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function B(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,s=Math.min(t.length-n,4);o<s;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function L(t,e,n,r,o,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function C(t,e,n,r,s){return s||L(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function U(t,e,n,r,s){return s||L(t,0,n,8),o.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var o=e-t;n=new u(o,void 0);for(var s=0;s<o;++s)n[s]=this[s+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],o=1,s=0;++s<e&&(o*=256);)r+=this[t+s]*o;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},u.prototype.readUInt8=function(t,e){return e||T(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||T(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||T(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],o=1,s=0;++s<e&&(o*=256);)r+=this[t+s]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=e,o=1,s=this[t+--r];r>0&&(o*=256);)s+=this[t+--r]*o;return s>=(o*=128)&&(s-=Math.pow(2,8*e)),s},u.prototype.readInt8=function(t,e){return e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||T(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||T(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||T(t,4,this.length),o.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||T(t,4,this.length),o.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||T(t,8,this.length),o.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||T(t,8,this.length),o.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Y(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,s=0;for(this[e]=255&t;++s<n&&(o*=256);)this[e+s]=t/o&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Y(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,s=1;for(this[e+o]=255&t;--o>=0&&(s*=256);)this[e+o]=t/s&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);Y(this,t,e,n,o-1,-o)}var s=0,i=1,a=0;for(this[e]=255&t;++s<n&&(i*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/i>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);Y(this,t,e,n,o-1,-o)}var s=n-1,i=1,a=0;for(this[e+s]=255&t;--s>=0&&(i*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/i>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):B(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Y(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return C(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return C(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,s=r-n;if(this===t&&n<e&&e<r)for(o=s-1;o>=0;--o)t[o+e]=this[o+n];else if(s<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var i=u.isBuffer(t)?t:D(new u(t,r).toString()),a=i.length;for(s=0;s<n-e;++s)this[s+e]=i[s%a]}return this};var X=/[^+\/0-9A-Za-z-_]/g;function O(t){return t<16?"0"+t.toString(16):t.toString(16)}function D(t,e){var n;e=e||1/0;for(var r=t.length,o=null,s=[],i=0;i<r;++i){if((n=t.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(i+1===r){(e-=3)>-1&&s.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&s.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function F(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(X,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(7))},function(t,e,n){"use strict";e.byteLength=function(t){var e=h(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=h(t),r=n[0],i=n[1],a=new s(function(t,e,n){return 3*(e+n)/4-n}(0,r,i)),u=0,c=i>0?r-4:r,l=0;l<c;l+=4)e=o[t.charCodeAt(l)]<<18|o[t.charCodeAt(l+1)]<<12|o[t.charCodeAt(l+2)]<<6|o[t.charCodeAt(l+3)],a[u++]=e>>16&255,a[u++]=e>>8&255,a[u++]=255&e;2===i&&(e=o[t.charCodeAt(l)]<<2|o[t.charCodeAt(l+1)]>>4,a[u++]=255&e);1===i&&(e=o[t.charCodeAt(l)]<<10|o[t.charCodeAt(l+1)]<<4|o[t.charCodeAt(l+2)]>>2,a[u++]=e>>8&255,a[u++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,s=[],i=0,a=n-o;i<a;i+=16383)s.push(c(t,i,i+16383>a?a:i+16383));1===o?(e=t[n-1],s.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return s.join("")};for(var r=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=i.length;a<u;++a)r[a]=i[a],o[i.charCodeAt(a)]=a;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var o,s,i=[],a=e;a<n;a+=3)o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),i.push(r[(s=o)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return i.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var s,i,a=8*o-r-1,u=(1<<a)-1,h=u>>1,c=-7,l=n?o-1:0,f=n?-1:1,g=t[e+l];for(l+=f,s=g&(1<<-c)-1,g>>=-c,c+=a;c>0;s=256*s+t[e+l],l+=f,c-=8);for(i=s&(1<<-c)-1,s>>=-c,c+=r;c>0;i=256*i+t[e+l],l+=f,c-=8);if(0===s)s=1-h;else{if(s===u)return i?NaN:1/0*(g?-1:1);i+=Math.pow(2,r),s-=h}return(g?-1:1)*i*Math.pow(2,s-r)},e.write=function(t,e,n,r,o,s){var i,a,u,h=8*s-o-1,c=(1<<h)-1,l=c>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:s-1,p=r?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,i=c):(i=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-i))<1&&(i--,u*=2),(e+=i+l>=1?f/u:f*Math.pow(2,1-l))*u>=2&&(i++,u/=2),i+l>=c?(a=0,i=c):i+l>=1?(a=(e*u-1)*Math.pow(2,o),i+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,o),i=0));o>=8;t[n+g]=255&a,g+=p,a/=256,o-=8);for(i=i<<o|a,h+=o;h>0;t[n+g]=255&i,g+=p,i/=256,h-=8);t[n+g-p]|=128*d}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){for(var r=n(16),o=[],s={},i=0;i<256;i++)o[i]=(i+256).toString(16).substr(1),s[o[i]]=i;function a(t,e){var n=e||0,r=o;return r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]}var u=r(),h=[1|u[0],u[1],u[2],u[3],u[4],u[5]],c=16383&(u[6]<<8|u[7]),l=0,f=0;function g(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var i=0;i<16;i++)e[o+i]=s[i];return e||a(s)}var p=g;p.v1=function(t,e,n){var r=e&&n||0,o=e||[],s=void 0!==(t=t||{}).clockseq?t.clockseq:c,i=void 0!==t.msecs?t.msecs:(new Date).getTime(),u=void 0!==t.nsecs?t.nsecs:f+1,g=i-l+(u-f)/1e4;if(g<0&&void 0===t.clockseq&&(s=s+1&16383),(g<0||i>l)&&void 0===t.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=i,f=u,c=s;var p=(1e4*(268435455&(i+=122192928e5))+u)%4294967296;o[r++]=p>>>24&255,o[r++]=p>>>16&255,o[r++]=p>>>8&255,o[r++]=255&p;var d=i/4294967296*1e4&268435455;o[r++]=d>>>8&255,o[r++]=255&d,o[r++]=d>>>24&15|16,o[r++]=d>>>16&255,o[r++]=s>>>8|128,o[r++]=255&s;for(var b=t.node||h,y=0;y<6;y++)o[r+y]=b[y];return e||a(o)},p.v4=g,p.parse=function(t,e,n){var r=e&&n||0,o=0;for(e=e||[],t.toLowerCase().replace(/[0-9a-f]{2}/g,function(t){o<16&&(e[r+o++]=s[t])});o<16;)e[r+o++]=0;return e},p.unparse=a,t.exports=p},function(t,e,n){(function(e){var n,r=e.crypto||e.msCrypto;if(r&&r.getRandomValues){var o=new Uint8Array(16);n=function(){return r.getRandomValues(o),o}}if(!n){var s=new Array(16);n=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}t.exports=n}).call(this,n(7))},function(t,e,n){"use strict";n.r(e),n.d(e,"rnaPlot",function(){return i});var r=n(6),o=(n(4),n(8)),s=n(9);n(28);function i(){var t,e,n={width:300,height:300,nucleotideRadius:5,rnaEdgePadding:1,labelInterval:10,showNucleotideLabels:!0,startNucleotideNumber:1,bundleExternalLinks:!1,rnaLayout:"simple",namePosition:"0 0"};function i(i){i.each(function(i){var a=new r.a(i.sequence,i.structure,i.name,n.startNucleotideNumber).recalculateElements().elementsToJson().addName(i.name);i.rnaGraph=a;var u=[];if("naview"===n.rnaLayout)for(var h=(new s.a).naview_xy_coordinates(a.pairtable),c=0;c<h.nbase;c++)u.push([h.x[c],h.y[c]]);else u=Object(o.a)(a.pairtable);a.addPositions("nucleotide",u).reinforceStems().reinforceLoops().addExtraLinks(i.extraLinks).addLabels(n.startNucleotideNumber,n.labelInterval);var l=function(r,o){var s=d3.extent(r),i=d3.extent(o);s[0]-=n.nucleotideRadius+n.rnaEdgePadding,i[0]-=n.nucleotideRadius+n.rnaEdgePadding,s[1]+=n.nucleotideRadius+n.rnaEdgePadding,i[1]+=n.nucleotideRadius+n.rnaEdgePadding;var a,u=s[1]-s[0],h=i[1]-i[0];function c(t,e,n){var r=(t.range()[1]-t.range()[0])/(t.domain()[1]-t.domain()[0]),o=(e[1]-e[0])*r,s=(n[1]-n[0]-o)/2;return{scaleFactor:r,scale:d3.scale.linear().domain(e).range([n[0]+s,n[1]-s])}}return u-n.width>h-n.height?(a=c(t=d3.scale.linear().domain(s).range([0,n.width]),i,[0,n.height]),e=a.scale):(a=c(e=d3.scale.linear().domain(i).range([0,n.height]),s,[0,n.width]),t=a.scale),t.range()[0],t.domain()[0],e.range()[0],e.domain()[0],"translate("+-(t.domain()[0]*a.scaleFactor-t.range()[0])+","+-(e.domain()[0]*a.scaleFactor-e.range()[0])+")scale("+a.scaleFactor+")"}(a.nodes.map(function(t){return t.x}),a.nodes.map(function(t){return t.y})),f=d3.select(this).append("g").attr("transform",l),g=a.nodes.filter(function(t){return"nucleotide"==t.nodeType}),p=a.nodes.filter(function(t){return"label"==t.nodeType}),d=a.links;!function(t,e){e=e.filter(function(t){return null!==t.source&&null!==t.target}),t.selectAll(".rna-link").data(e).enter().append("svg:line").attr("x1",function(t){return t.source.x}).attr("x2",function(t){return t.target.x}).attr("y1",function(t){return t.source.y}).attr("y2",function(t){return t.target.y}).attr("link-type",function(t){return t.linkType}).attr("extra-link-type",function(t){return t.extraLinkType}).classed("rna-link",!0)}(f,d),function(t,e){var r=t.selectAll(".rna-base").data(e).enter().append("svg:g").attr("transform",function(t){return"translate("+t.x+","+t.y+")"});r.append("svg:circle").attr("r",n.nucleotideRadius).classed("rna-base",!0),n.showNucleotideLabels&&r.append("svg:text").text(function(t){return t.name}).attr("text-anchor","middle").attr("dominant-baseline","central").classed("nucleotide-label",!0).append("svg:title").text(function(t){return t.struct_name+":"+t.num})}(f,g),function(t,e){var r=t.selectAll(".rnaLabel").data(e).enter().append("svg:g").attr("transform",function(t){return"translate("+t.x+","+t.y+")"});r.append("svg:circle").attr("r",n.nucleotideRadius).classed("rna-base",!0).classed("label",!0),r.append("svg:text").text(function(t){return t.name}).attr("text-anchor","middle").attr("font-weight","bold").attr("dominant-baseline","central").classed("number-label",!0)}(f,p),function(t,e){var r=t.append("svg:text").classed("rna-name",!0).attr("text-anchor","middle").attr("alignment-baseline","central").text(e),o=n.namePosition.split(" ",2),s=[],i=r.node().getBBox(),a=[i.width,i.height],u=[n.width,n.height];for(var h in[0,1])switch(o[h]){case"0":s[h]=a[h]/2;break;case"1":s[h]=u[h]-a[h]/2;break;case"0.5":s[h]=u[h]/2}r.attr("x",s[0]).attr("y",s[1])}(d3.select(this),i.name),n.bundleExternalLinks&&function(t,e){var n={},r=[];e=e.filter(function(t){return"correct"==t.linkType||"incorrect"==t.linkType||"extra"==t.linkType}),t.selectAll("[link-type=extra]").remove();for(var o=0;o<e.length;o++)null!==e[o].source&&null!==e[o].target&&(n[e[o].source.uid]=e[o].source,n[e[o].target.uid]=e[o].target,r.push({source:e[o].source.uid,target:e[o].target.uid,linkType:e[o].linkType,extraLinkType:e[o].extraLinkType}));var s=d3.ForceEdgeBundling().nodes(n).edges(r).compatibility_threshold(.8).step_size(.2)(),i=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear");for(o=0;o<s.length;o++){var a=s[o];t.append("path").attr("d",i(a)).style("fill","none").attr("link-type",function(t){return r[o].linkType}).attr("extra-link-type",function(t){return r[o].extraLinkType}).style("stroke-opacity",.4)}}(f,d)})}return i.width=function(t){return arguments.length?(n.width=t,i):n.width},i.height=function(t){return arguments.length?(n.height=t,i):n.height},i.showNucleotideLabels=function(t){return arguments.length?(n.showNucleotideLabels=t,i):n.showNucleotideLabels},i.rnaEdgePadding=function(t){return arguments.length?(n.rnaEdgePadding=t,i):n.rnaEdgePadding},i.nucleotideRadius=function(t){return arguments.length?(n.nucleotideRadius=t,i):n.nucleotideRadius},i.labelInterval=function(t){return arguments.length?(n.labelInterval=t,i):n.labelInterval},i.showNucleotideLabels=function(t){return arguments.length?(n.showNucleotideLabels=t,i):n.showNucleotideLabels},i.startNucleotideNumber=function(t){return arguments.length?(n.startNucleotideNumber=t,i):n.startNucleotideNumber},i.bundleExternalLinks=function(t){return arguments.length?(n.bundleExternalLinks=t,i):n.bundleExternalLinks},i.rnaLayout=function(t){return arguments.length?(n.rnaLayout=t,i):n.rnaLayout},i.namePosition=function(t){return arguments.length?(n.namePosition=t,i):n.namePosition},i}},function(t,e,n){t.exports=n(17)},,,,,,,,,,function(t,e){}])});